"0","if(keep_time) tic(""Edge analysis"")"
"0","# this calculates the empirical quantile of edge betweenness"
"0","# by dataset and method: I suppose one can then select those >0.95"
"0","# to get a sort of hubness for edges, but it makes sense only for "
"0","# large number of edges"
"0","edge_list_df <- edge_list_df %>% group_by(dataset, method) %>%"
"0","  mutate(ebq = ecdf(edge_betw)(edge_betw)) %>% ungroup()"
"0",""
"0","# calculate the frequency of edges, by study and type and "
"0","# median value and IQR for IQR"
"0","# this only checks for conserved edges across methods"
"0","edge_freq_bystudy <- edge_list_df %>% "
"0","  group_by(dataset, asso_type, edge_name) %>% "
"0","  summarise(n = n(),"
"0","            med_ebq = median(ebq),"
"0","            iqr_ebq = IQR(ebq)) %>%"
"0","  arrange(-n, -med_ebq, ) %>% "
"0","  ungroup()"
"2","`summarise()` has grouped output by 'dataset', 'asso_type'. You can override using the `.groups` argument.
"
"0","# I am now generating a plot may be with the top 50 edges, only for FMBN studies"
"0","edge_freq_bystudy_FMBN <- edge_freq_bystudy %>%"
"0","  dplyr::filter(str_detect(dataset, ""FMBN"")) %>%"
"0","  arrange(-n, -med_ebq)"
"0",""
"0","# let's try a plot (gives an emphasis to most stable edges)"
"0","slice_to_plot <- slice(edge_freq_bystudy_FMBN, 1:50) %>%"
"0","    mutate(edge_name = forcats::fct_reorder(edge_name, med_ebq)) "
"0",""
"0","ggplot(slice_to_plot, "
"0","       mapping = aes(x = edge_name, y = med_ebq, size = n, color = asso_type)) +"
"0","  geom_point() + "
"0","  coord_flip() +"
"0","  labs(x = ""edge"", y = ""edge betweenness quantile"","
"0","      size = ""edge freq."") +"
"0","    scale_colour_manual(values = c(""green"",""red""))"
